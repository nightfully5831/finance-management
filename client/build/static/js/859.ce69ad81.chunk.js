"use strict";(self.webpackChunkfinance_dashboard=self.webpackChunkfinance_dashboard||[]).push([[859],{96602:(e,t,a)=>{a.d(t,{BO:()=>n,I0:()=>c,K_:()=>s});var r=a(63204);const s=async(e,t)=>{const a=[];e.data.map((e=>{const r=[...e];r[1]=r[3],r[3]=r[2],r[4]=0;let s=!1;return t.map((e=>(e[0].toString()===r[0]&&(r[2]=e[2],s=!0),!0))),!0===s&&a.push(r),!0})),e.data=a;try{let t="";return await r.Ay.post(r.vZ.forecast.create,e).then((e=>{t="success"})).catch((e=>{t="error"})),t}catch(s){throw console.log("Error Create Forecast",s),s}},n=async e=>{const t=[],a=JSON.parse(JSON.stringify(e));e.data.forEach((e=>{t.push([e.AccountId,e.RevenueExpenseId,e.Description,0,e.result])})),a.data=t;try{let e="";return await r.Ay.post(r.vZ.forecast.update,a).then((t=>{e="success"})).catch((t=>{e="error"})),e}catch(s){throw console.error("Error fetching Revenue By Month:",s),s}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.forecast.get,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},923:(e,t,a)=>{a.d(t,{An:()=>d,Kf:()=>u,Qw:()=>i,Vp:()=>l,au:()=>c,om:()=>s,pC:()=>n,vp:()=>o});var r=a(63204);const s=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenueByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}},n=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenue,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheet,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},o=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheetByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Balance Sheet By Month:",t),t}},d=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.getCOA,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},l=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},u=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},i=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.log("Error Create COA",t),[]}}},40019:(e,t,a)=>{a.d(t,{A:()=>C});var r=a(11238),s=a(65043),n=a(7353),c=a(12110),o=a(94496),d=a(67784),l=a(51787),u=a(17392),i=a(49633),h=a(79650),p=a(71806),y=a(84882),f=a(68738),g=a(39652),x=a(58093),A=a(73460),v=a(68039),S=a(79484),m=a(34535),w=a(51975),j=a(70579);const R=(0,m.Ay)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});const C=function(e){let{onSetResult:t,currentResult:a,titleArray:m}=e;const[C,I]=(0,s.useState)([]),[b,E]=(0,s.useState)(""),[M,B]=(0,s.useState)(""),[U,Y]=(0,s.useState)(""),[Z,_]=(0,s.useState)("asc"),[F,P]=(0,s.useState)(0),[O,k]=(0,s.useState)(7),D=e=>{const a=e.target.files[0];if(a){const e=new FileReader;e.onload=e=>{const a=new Uint8Array(e.target.result),s=r.LF(a,{type:"array"}),n=s.SheetNames[0],c=s.Sheets[n],o=r.Wp.sheet_to_json(c,{header:1});if(o.length>0){const e=(e=>{const t=[];return e.filter((e=>0!==e.length)).map((e=>{const a=[...e];return"string"!==typeof e[0]&&(a[0]=a[0].toString()),"Roll UP"!==m[2]&&(e[1]&&e[3]?("string"!==typeof e[1]&&(a[1]=a[1].toString()),"string"!==typeof e[3]&&(a[3]=a[3].toString())):(a[1]="",a[3]="")),t.push(a),!0})),t})(o.slice(1));t(e)}},e.readAsArrayBuffer(a)}},z=[...C].sort(((e,t)=>{if(!U)return 0;const a=m.indexOf(U);return e[a]<t[a]?"asc"===Z?-1:1:e[a]>t[a]?"asc"===Z?1:-1:0})).filter((e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.toString().includes(b)})),K=z.slice(F*O,F*O+O);return(0,s.useEffect)((()=>{I(a)}),[a]),(0,j.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",position:"relative",width:"100%",justifyContent:"top",alignItems:"center"},children:(0,j.jsxs)(c.A,{sx:{width:"100%",p:2},children:[(0,j.jsxs)(o.A,{sx:{fontWeight:"500",fontSize:"18px"},children:["Roll UP"===m[2]?"Chart of Account":"Monthly Result"," Table"]}),(0,j.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2},children:[(0,j.jsx)(d.A,{variant:"outlined",size:"small",value:M,onChange:e=>{B(e.target.value)},placeholder:"Search by AccountID",InputProps:{endAdornment:(0,j.jsx)(l.A,{position:"end",children:(0,j.jsx)(u.A,{edge:"end",color:"primary",onClick:()=>{E(M)},children:(0,j.jsx)(S.A,{})})})},sx:{width:"40%"}}),(0,j.jsxs)(i.A,{component:"label",color:"primary",variant:"contained",startIcon:(0,j.jsx)(w.A,{}),children:["Upload files",(0,j.jsx)(R,{type:"file",accept:".xlsx",onChange:e=>D(e),multiple:!1})]})]}),(0,j.jsx)(h.A,{children:(0,j.jsxs)(p.A,{children:[(0,j.jsx)(y.A,{children:(0,j.jsx)(f.A,{children:m.map(((e,t)=>(0,j.jsx)(g.A,{style:{textAlign:"center"},children:(0,j.jsx)(x.A,{active:U===e,direction:U===e?Z:"asc",onClick:()=>{return _(U===(t=e)&&"asc"===Z?"desc":"asc"),void Y(t);var t},children:e})},t)))})}),(0,j.jsx)(A.A,{children:K.map(((e,t)=>(0,j.jsx)(f.A,{children:e.map(((e,t)=>(0,j.jsx)(g.A,{style:{padding:"20px",textAlign:"center"},children:e},t)))},t)))})]})}),(0,j.jsx)(v.A,{rowsPerPageOptions:[7,15,20],component:"div",count:z.length,rowsPerPage:O,page:F,onPageChange:(e,t)=>{P(t)},onRowsPerPageChange:e=>{k(parseInt(e.target.value,10)),P(0)}})]})})}},78859:(e,t,a)=>{a.r(t),a.d(t,{default:()=>I});var r=a(29490),s=a(65043),n=a(19252),c=a(7353),o=a(94496),d=a(74161),l=a(56813),u=a(57488),i=(a(92342),a(60446)),h=a.n(i),p=a(43374),y=a(923),f=a(39098),g=a(75139),x=a(40019),A=a(96602);const v=(e,t)=>{const a=[],r=[];return e.map((e=>(t.map((t=>(t[0]===e[0]&&("BS"!==t[3]?a.push(e):r.push(e)),!0))),!0))),{IS:a,BS:r}},S=(e,t)=>Object.values(e.reduce(((e,a)=>{let r="";return r="IS"===t?a[3]:a[0],e[r]?e[r][2]+=a[2]:e[r]=[...a],e}),{})),m=async(e,t,a,r)=>{if(e.data&&0!==e.data.length){const s=await(0,y.Vp)(e);"success"===s.type?(u.oR.success("Revenue Successfully Created",{theme:"colored"}),t(s.data)):u.oR.error("Revenue Create Error",{theme:"colored"});"success"===await(0,A.K_)(e,r)?u.oR.success("Forecast Successfully Created",{theme:"colored"}):u.oR.error("Forecast Create Error",{theme:"colored"}),a(!1)}else console.log("Monthly Result data required!"),a(!1)},w=async(e,t,a)=>{if(e.data&&0!==e.data.length){const r=await(0,y.Kf)(e);"success"===r.type?(u.oR.success("BS Successfully created",{theme:"colored"}),a(r.data)):u.oR.error("BS Create Error",{theme:"colored"}),t(!1)}else console.log("BS data required!"),t(!1)};var j=a(70579);const R=["AccountID","Revenue/Expense Description","Amount($)","Revenue/Expense ID"];function C(){const e=(0,f.Mp)(),{user:t}=(0,g.Z)(),[a,r]=(0,s.useState)(h()()),[i,A]=(0,s.useState)([]),[C,I]=(0,s.useState)([]),[b,E]=(0,s.useState)(!1),[M,B]=(0,s.useState)([]),[U,Y]=(0,s.useState)([]);return(0,s.useEffect)((()=>{(async()=>{const e=1===t.role?{userId:t._id}:{userId:t.parent},a=await(0,y.An)(e);"success"===a.type?(u.oR.success("COA Successfully Upload!",{theme:"colored"}),I(a.data)):u.oR.error("COA Upload Error",{theme:"colored"})})(),(async()=>{const e=h()(a).format("MMMM YYYY"),r=1===t.role?{userId:t._id,date:e}:{userId:t.parent,date:e},s=await(0,y.pC)(r);"success"===s.type?(u.oR.success("Revenue Successfully Upload!",{theme:"colored"}),B(s.data)):u.oR.error("Revenue Upload Error",{theme:"colored"})})(),(async()=>{const e=h()(a).format("MMMM YYYY"),r=1===t.role?{userId:t._id,date:e}:{userId:t.parent,date:e},s=await(0,y.au)(r);"success"===s.type?(u.oR.success("BalanceSheet Successfully Upload!",{theme:"colored"}),Y(s.data)):u.oR.error("BalanceSheet Upload Error",{theme:"colored"})})()}),[a,t._id,t.parent,t.role]),(0,s.useEffect)((()=>{const e=[...M,...U];A(e)}),[M,U]),(0,j.jsxs)(n.A,{maxWidth:!e.themeStretch&&"xl",children:[(0,j.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2},children:[(0,j.jsx)(o.A,{variant:"h4",children:" Upload Transactions "}),(0,j.jsx)(c.A,{sx:{display:"flex",justifyContent:"flex-end",mr:4,border:"2px solid",borderColor:"#007867",borderRadius:1,p:.2},children:(0,j.jsx)(l.l,{views:["month","year"],value:a,onChange:e=>{r(e)}})})]}),(0,j.jsx)(x.A,{onSetResult:e=>{const t=v(e,C),a=S(t.IS,"IS"),r=S(t.BS,"BS"),s=[...a,...r];B(a),Y(r),A(s)},currentResult:i,titleArray:R}),(0,j.jsx)(d.A,{component:"label",color:"primary",variant:"contained",onClick:async()=>{E(!0);const e=h()(a).format("MMMM YYYY"),r=100*h()(a).year()+h()(a).month(),s=1===t.role?{userId:t._id,date:e,dateFlag:r,data:M}:{userId:t.parent,date:e,dateFlag:r,data:M},n=1===t.role?{userId:t._id,date:e,dateFlag:r,data:U}:{userId:t.parent,date:e,dateFlag:r,data:U};m(s,B,E,C),w(n,E,Y),A([...M,...U])},loading:b,sx:{mt:2,mb:2},startIcon:(0,j.jsx)(p.A,{}),children:"Submit"})]})}function I(){return(0,j.jsxs)(j.Fragment,{children:[(0,j.jsx)(r.mg,{children:(0,j.jsx)("title",{children:" Dashboard: TransactionUpload"})}),(0,j.jsx)(C,{})]})}},51975:(e,t,a)=>{a.d(t,{A:()=>n});var r=a(66734),s=a(70579);const n=(0,r.A)((0,s.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload")},92342:()=>{}}]);
//# sourceMappingURL=859.ce69ad81.chunk.js.map