"use strict";(self.webpackChunkfinance_dashboard=self.webpackChunkfinance_dashboard||[]).push([[486],{96602:(e,t,a)=>{a.d(t,{BO:()=>s,I0:()=>c,K_:()=>n});var r=a(63204);const n=async(e,t)=>{const a=[];e.data.map((e=>{const r=[...e];r[1]=r[3],r[3]=r[2],r[4]=0;let n=!1;return t.map((e=>(e[0].toString()===r[0]&&(r[2]=e[2],n=!0),!0))),!0===n&&a.push(r),!0})),e.data=a;try{let t="";return await r.Ay.post(r.vZ.forecast.create,e).then((e=>{t="success"})).catch((e=>{t="error"})),t}catch(n){throw console.log("Error Create Forecast",n),n}},s=async e=>{const t=[],a=JSON.parse(JSON.stringify(e));e.data.forEach((e=>{t.push([e.AccountId,e.RevenueExpenseId,e.Description,0,e.result])})),a.data=t;try{let e="";return await r.Ay.post(r.vZ.forecast.update,a).then((t=>{e="success"})).catch((t=>{e="error"})),e}catch(n){throw console.error("Error fetching Revenue By Month:",n),n}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.forecast.get,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},923:(e,t,a)=>{a.d(t,{An:()=>l,Kf:()=>i,Qw:()=>u,Vp:()=>d,_h:()=>h,au:()=>c,om:()=>n,pC:()=>s,vp:()=>o});var r=a(63204);const n=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenueByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}},s=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenue,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheet,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},o=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheetByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Balance Sheet By Month:",t),t}},l=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.getCOA,{userId:e}).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},d=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},i=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},u=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.log("Error Create COA",t),[]}},h=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getAllRevenue,{userId:e}).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},47486:(e,t,a)=>{a.r(t),a.d(t,{default:()=>$});var r=a(29490),n=a(89379),s=a(60446),c=a.n(s),o=a(7353),l=a(19252),d=a(94496),i=a(43374),u=a(74161),h=a(53536),p=a(57488),x=a(65043),A=a(39098),m=a(75139),g=a(96602),y=a(12110),f=a(68039),v=a(97892),j=a(67784),I=a(51787),w=a(17392),S=a(49633),R=a(56813),b=a(79484),E=a(70579);const D=e=>{let{inputRef:t,date:a,setDate:r,selectedDate:n,setExportData:s,handleDateChange:c,addEditableRow:l,handleSearch:d}=e;return(0,E.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2},children:[(0,E.jsx)(j.A,{variant:"outlined",size:"small",inputRef:t,placeholder:"Search by AccountID",InputProps:{endAdornment:(0,E.jsx)(I.A,{position:"end",children:(0,E.jsx)(w.A,{edge:"end",color:"primary",onClick:d,children:(0,E.jsx)(b.A,{})})})},sx:{width:"20%"}}),(0,E.jsx)(o.A,{sx:{display:"flex",justifyContent:"flex-end",mr:4,ml:4,border:"2px solid",borderColor:"#007867",borderRadius:1,p:.2},children:(0,E.jsx)(R.l,{label:null===a?"Forecast":"",views:["month","year"],value:a,onChange:e=>r(e)})}),(0,E.jsxs)(o.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mr:4,border:"2px solid",borderColor:"#007867",borderRadius:1,p:.2},children:[(0,E.jsx)(R.l,{label:null===n.from?"From":"",views:["month","year"],value:n.from,onChange:e=>c(e,!0)}),(0,E.jsx)(o.A,{sx:{mx:1},children:"-"}),(0,E.jsx)(R.l,{label:null===n.to?"To":"",views:["month","year"],value:n.to,onChange:e=>c(e,!1)})]}),(0,E.jsx)(S.A,{variant:"contained",color:"primary",sx:{mr:3},onClick:()=>s(!0),children:"Export"}),(0,E.jsx)(S.A,{variant:"contained",color:"primary",sx:{mr:3},onClick:l,children:"Add"})]})};var C=a(79650),M=a(71806),N=a(84882),F=a(68738),k=a(39652),B=a(58093),P=a(73460);const O=e=>{let{header:t=[],month:a=[],paginatedData:r=[],newRow:n,handleRequestSort:s,orderDirection:c,changeUserInfo:o,handleInputChange:l,saveNewRow:d,cancelNewRow:i,orderBy:u}=e;return(0,E.jsx)(C.A,{children:(0,E.jsxs)(M.A,{children:[(0,E.jsxs)(N.A,{children:[(0,E.jsxs)(F.A,{children:[t.map(((e,t)=>(0,E.jsx)(k.A,{rowSpan:2,style:{textAlign:"center"},children:(0,E.jsx)(B.A,{active:u===e,direction:u===e?c:"asc",onClick:()=>s(e),children:e})},t))),a.map(((e,t)=>(0,E.jsx)(k.A,{colSpan:2,sx:{textAlign:"center"},children:e},t))),(0,E.jsx)(k.A,{rowSpan:2,children:"Adjustment"}),(0,E.jsx)(k.A,{rowSpan:2,children:"Forecast"})]}),(0,E.jsx)(F.A,{children:a.map(((e,t)=>(0,E.jsxs)(x.Fragment,{children:[(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:"Actual"}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:"Forecast"})]},t)))})]}),(0,E.jsxs)(P.A,{children:[r.map(((e,t)=>(0,E.jsxs)(F.A,{sx:{textAlign:"center"},children:[(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.AccountId}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.RevenueExpenseId}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.Description}),e.data.map(((e,t)=>(0,E.jsxs)(x.Fragment,{children:[(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.actual}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.forecast})]},t))),(0,E.jsx)(k.A,{children:(0,E.jsx)(j.A,{type:"number",value:e.userInfo,size:"small",sx:{maxWidth:65},onChange:t=>o(t.target.value,e.RevenueExpenseId)})}),(0,E.jsx)(k.A,{children:e.result})]},t))),n&&(0,E.jsxs)(F.A,{sx:{textAlign:"center"},children:[(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:(0,E.jsx)(j.A,{value:n.AccountId,onChange:e=>l("AccountId",e.target.value),size:"small"})}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:(0,E.jsx)(j.A,{value:n.RevenueExpenseId,onChange:e=>l("RevenueExpenseId",e.target.value),size:"small"})}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:(0,E.jsx)(j.A,{value:n.Description,onChange:e=>l("Description",e.target.value),size:"small"})}),n.data.map(((e,t)=>(0,E.jsxs)(x.Fragment,{children:[(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:"0"}),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:"0"})]},t))),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:(0,E.jsx)(j.A,{type:"number",value:n.userInfo,sx:{maxWidth:65},onChange:e=>l("userInfo",e.target.value),size:"small"})}),(0,E.jsxs)(k.A,{sx:{textAlign:"center"},children:[(0,E.jsx)(S.A,{onClick:d,children:"Save"}),(0,E.jsx)(S.A,{onClick:i,children:"Cancel"})]})]})]})]})})},_=e=>{let{currentResult:t,month:a,date:r,setDate:s,changeResult:c,handleDateChange:l,selectedDate:d}=e;const[i,u]=(0,x.useState)([]),[A,m]=(0,x.useState)(""),g=(0,x.useRef)(null),[j,I]=(0,x.useState)(""),[w,S]=(0,x.useState)("asc"),[R,b]=(0,x.useState)(0),[C,M]=(0,x.useState)(10),[N,F]=(0,x.useState)(null),[k,B]=(0,x.useState)(!1),P=[...i].sort(((e,t)=>{var a,r;if(!j)return 0;const n={AccountID:"AccountId",RevenueExpenseID:"RevenueExpenseId",Description:"Description"}[j];if(!n)return 0;const s=null!==(a=e[n])&&void 0!==a?a:"",c=null!==(r=t[n])&&void 0!==r?r:"";if("string"===typeof s&&"string"===typeof c)return"asc"===w?s.localeCompare(c):c.localeCompare(s);const o=parseFloat(s),l=parseFloat(c);return Number.isNaN(o)||Number.isNaN(l)?0:"asc"===w?o-l:l-o})).filter((e=>{var t;return null===(t=e.AccountId)||void 0===t?void 0:t.includes(A)})),_=P.slice(R*C,R*C+C);(0,x.useEffect)((()=>{u(t)}),[t]),(0,x.useEffect)((()=>{k&&(0===i.length||0===a.length||null===r?p.oR.warn("Export data is missing",{theme:"colored"}):(0,v.b)({data:i,month:a,fileName:"forecast ".concat(r),type:"forecast"}),B(!1))}),[k,i,r,a]);return(0,E.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",position:"relative",width:"100%",justifyContent:"top",alignItems:"center"},children:(0,E.jsxs)(y.A,{sx:{width:"100%",p:2},children:[(0,E.jsx)(D,{inputRef:g,date:r,setDate:s,handleSearch:()=>{m(g.current.value)},addEditableRow:()=>{F({AccountId:"",RevenueExpenseId:"",Description:"",data:a.map((()=>({actual:0,forecast:0}))),average:0,userInfo:0,result:0})},selectedDate:d,handleDateChange:l,setExportData:B}),(0,E.jsx)(O,{header:["AccountID","RevenueExpenseID","Description"],month:a,paginatedData:_,newRow:N,handleRequestSort:e=>{S(j===e&&"asc"===w?"desc":"asc"),I(e)},orderDirection:w,changeUserInfo:(e,t)=>{const a=i.map((a=>{let r=0;r=(0,h.parseInt)(e),""!==e&&void 0!==e||(r=0),""!==a.average&&void 0!==a.average||(a.average=0);const s=(0,h.parseInt)(a.average+r);return a.RevenueExpenseId===t?(0,n.A)((0,n.A)({},a),{},{userInfo:e,result:s}):a}));c(a)},handleInputChange:(e,t)=>{F((a=>(0,n.A)((0,n.A)({},a),{},{[e]:t})))},saveNewRow:()=>{let e=!0;if(""===N.AccountID&&""===N.RevenueExpenseId&&""===N.Description&&0===N.userInfo&&(e=!1,p.oR.warn("Missing Value",{theme:"colored"})),N&&e){const e=[...i,N];c(e),F(null)}},cancelNewRow:()=>{F(null)},orderBy:j}),(0,E.jsx)(f.A,{rowsPerPageOptions:[5,10,25],component:"div",count:P.length,rowsPerPage:C,page:R,onPageChange:(e,t)=>{b(t)},onRowsPerPageChange:e=>{M((0,h.parseInt)(e.target.value,10)),b(0)}})]})})};var J=a(923);const Z=e=>{let{inputRef:t,selectedDate:a,handleDateChange:r,handleSearch:n,setExportData:s}=e;return(0,E.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2},children:[(0,E.jsx)(j.A,{variant:"outlined",size:"small",inputRef:t,placeholder:"Search by AccountID",InputProps:{endAdornment:(0,E.jsx)(I.A,{position:"end",children:(0,E.jsx)(w.A,{edge:"end",color:"primary",onClick:n,children:(0,E.jsx)(b.A,{})})})},sx:{width:"20%"}}),(0,E.jsxs)(o.A,{sx:{display:"flex",justifyContent:"flex-end",alignItems:"center",mr:4,border:"2px solid",borderColor:"#007867",borderRadius:1,p:.2},children:[(0,E.jsx)(R.l,{label:null===a.from?"From":"",views:["month","year"],value:a.from,onChange:e=>r(e,!0)}),(0,E.jsx)(o.A,{sx:{mx:1},children:"-"}),(0,E.jsx)(R.l,{label:null===a.to?"To":"",views:["month","year"],value:a.to,onChange:e=>r(e,!1)})]}),(0,E.jsx)(S.A,{variant:"contained",color:"primary",sx:{mr:3},onClick:()=>s(!0),children:"Export"})]})},T=e=>{let{month:t=[],paginatedData:a=[],orderBy:r,handleRequestSort:n,orderDirection:s}=e;return(0,E.jsx)(C.A,{children:(0,E.jsxs)(M.A,{children:[(0,E.jsx)(N.A,{children:(0,E.jsxs)(F.A,{children:[(0,E.jsx)(k.A,{style:{textAlign:"center"},children:(0,E.jsx)(B.A,{active:"AccountID"===r,direction:"AccountID"===r?s:"asc",onClick:()=>n("AccountID"),children:"AccountID"})}),t.length>0&&t.map(((e,t)=>(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e},t))),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:"LifeTime Balance"})]})}),(0,E.jsx)(P.A,{children:a.length>0&&a.map(((e,t)=>(0,E.jsxs)(F.A,{sx:{textAlign:"center"},children:[(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.AccountId}),e.data.length>0&&e.data.map(((e,t)=>(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.amount},t))),(0,E.jsx)(k.A,{sx:{textAlign:"center"},children:e.lifetime_balance})]},t)))})]})})},z=(e,t)=>{const a=new Map;e.forEach((e=>{e.data.forEach((t=>{let[r,n,s,c]=t;const o="".concat(r);a.has(o)||a.set(o,{AccountId:r,data:[]}),a.get(o).data.push({date:e.date,amount:s})}))}));const r=((e,t)=>{const a=JSON.parse(JSON.stringify(e));for(let r=0;r<a.length;r+=1){const e=a[r].data,n=[];for(let a=t.from;a<=t.to;a+=1){a%100===12&&(a=a-12+100);const t=e.find((e=>e.date===a));t?n.push(t):n.push({amount:0,date:a})}a[r].data=n}return a})(Array.from(a.values()),t);return r},U=["January","Feburary","March","April","May","June","July","August","September","October","November","December"],W=()=>{const[e,t]=(0,x.useState)([]),[a,r]=(0,x.useState)(""),s=(0,x.useRef)(null),[l,d]=(0,x.useState)(""),[i,u]=(0,x.useState)("asc"),[h,A]=(0,x.useState)(0),[g,j]=(0,x.useState)(10),[I,w]=(0,x.useState)({from:null,to:null}),[S,R]=(0,x.useState)(!1),[b,D]=(0,x.useState)([]),{user:C}=(0,m.Z)(),M=[...e].sort(((e,t)=>{var a,r;if(!l)return 0;const n={AccountID:"AccountId",RevenueExpenseID:"RevenueExpenseId",Description:"Description"}[l];if(!n)return 0;const s=null!==(a=e[n])&&void 0!==a?a:"",c=null!==(r=t[n])&&void 0!==r?r:"";if("string"===typeof s&&"string"===typeof c)return"asc"===i?s.localeCompare(c):c.localeCompare(s);const o=parseFloat(s),d=parseFloat(c);return Number.isNaN(o)||Number.isNaN(d)?0:"asc"===i?o-d:d-o})).filter((e=>{var t;return null===(t=e.AccountId)||void 0===t?void 0:t.includes(a)})),N=M.slice(h*g,h*g+g);return(0,x.useEffect)((()=>{(async()=>{try{if(null!==I.from&&null!==I.to){const e=100*c()(I.from).year()+c()(I.from).month(),a={from:e,to:100*c()(I.to).year()+c()(I.to).month()},r=1===C.role?{userId:C._id,date:a}:{userId:C.parent,date:a},n=await(0,J.vp)(r);"success"===n.type?p.oR.success("Balance Sheet successfully loaded!",{theme:"colored"}):p.oR.error("Update Balance Sheet Error",{theme:"colored"});const s=((e,t)=>{const a=[];return e.forEach((e=>{const t={date:"",data:[]};t.date=e.dateFlag,t.data=[...e.data],a.push(t)})),z(a,t)})(n.data.data,a),o=((e,t,a)=>{const r=[];for(let s=a.from;s<=a.to;s+=1)s%100===12&&(s=s-12+100),r.push({amount:0,date:s});const n=JSON.parse(JSON.stringify(e));for(let s=0;s<n.length;s+=1){let e=[];t.forEach((t=>{n[s].AccountId===t.AccountId&&(e=t.data)})),n[s].data=e,0===e.length&&(n[s].data=r)}return n})(n.data.total,s,a);t(o),(e=>{const t=[];e.forEach(((e,a)=>{const r=parseInt(e.date/100,10),n=e.date-100*r,s="".concat(U[n]," ").concat(r);t.push(s)})),D(t)})(s[0].data)}}catch(e){console.log("fetchBalanceSheet Error:",e)}})()}),[I,C._id,C.parent,C.role]),(0,x.useEffect)((()=>{S&&(0===e.length||0===b.length?p.oR.warn("Export data is missing",{theme:"colored"}):(0,v.b)({data:e,month:b,fileName:"balancesheet ".concat(I.from," - ").concat(I.to),type:"balancesheet"}),R(!1))}),[S,e,I,b]),(0,E.jsx)(o.A,{children:(0,E.jsxs)(y.A,{sx:{width:"100%",p:2},children:[(0,E.jsx)(Z,{handleSearch:()=>{r(s.current.value)},inputRef:s,setExportData:R,selectedDate:I,handleDateChange:(e,t)=>{if(!e)return;let a;a=t?(0,n.A)((0,n.A)({},I),{},{from:e}):(0,n.A)((0,n.A)({},I),{},{to:e}),w(a)}}),(0,E.jsx)(T,{paginatedData:N,orderBy:l,month:b,handleRequestSort:e=>{u(l===e&&"asc"===i?"desc":"asc"),d(e)},orderDirection:i}),(0,E.jsx)(f.A,{rowsPerPageOptions:[5,10,25],component:"div",count:M.length,rowsPerPage:g,page:h,onPageChange:(e,t)=>{A(t)},onRowsPerPageChange:e=>{j(parseInt(e.target.value,10)),A(0)}})]})})};var q=a(34535),Y=a(19042),L=a(88911);const V=(0,q.Ay)(Y.A)((e=>{let{theme:t}=e;return{width:70,height:30,borderRadius:15,padding:0,display:"flex","&:active":{"& .MuiSwitch-thumb":{width:20},"& .MuiSwitch-switchBase.Mui-checked":{transform:"translateX(40px)"}},"& .MuiSwitch-switchBase":{padding:2,"&.Mui-checked":{transform:"translateX(35px)",color:"#fff","& + .MuiSwitch-track":(0,n.A)({opacity:1},t.applyStyles("dark"))}},"& .MuiSwitch-thumb":{boxShadow:"0 2px 4px 0 rgb(0 35 11 / 20%)",width:24,height:24,borderRadius:20,transition:t.transitions.create(["width"],{duration:200})},"& .MuiSwitch-track":(0,n.A)({borderRadius:8,opacity:1,backgroundColor:"rgba(0,0,0,.25)",boxSizing:"border-box"},t.applyStyles("dark",{backgroundColor:"rgba(255,255,255,.35)"}))}})),X=e=>{let{setState:t,statement:a}=e;return(0,E.jsxs)(L.A,{direction:"row",spacing:1,sx:{alignItems:"center"},children:[(0,E.jsx)(d.A,{children:"BS"}),(0,E.jsx)(V,{defaultChecked:!0,value:a,onClick:()=>{t(!a)}}),(0,E.jsx)(d.A,{children:"IS"})]})},K=(e,t)=>{const a=new Map;e.forEach((e=>{e.data.forEach((t=>{let[r,n,s,c,o]=t;const l="".concat(r,"_").concat(n);a.has(l)||a.set(l,{AccountId:r,RevenueExpenseId:n,Description:s,data:[]}),a.get(l).data.push({date:e.date,actual:c,forecast:o})}))}));const r=((e,t)=>{const a=JSON.parse(JSON.stringify(e));for(let r=0;r<a.length;r+=1){const e=a[r].data,n=[];let s=0;for(let a=t.from;a<=t.to;a+=1){a%100===12&&(a=a-12+100);const t=e.find((e=>e.date===a));t?(n.push(t),s+=t.actual):n.push({actual:0,date:a,forecast:0})}a[r].data=n,a[r].average=parseFloat((s/n.length).toPrecision(5)),a[r].userInfo=0,a[r].result=parseFloat((s/n.length).toPrecision(5))}return a})(Array.from(a.values()),t);return r},G=(e,t)=>{const a=[];return e.forEach((e=>{const t={date:"",data:[]};t.date=e.dateFlag,t.data=[...e.data],a.push(t)})),K(a,t)},H=["January","Feburary","March","April","May","June","July","August","September","October","November","December"];function Q(){const e=(0,A.Mp)(),[t,a]=(0,x.useState)({from:null,to:null}),[r,s]=(0,x.useState)([]),[y,f]=(0,x.useState)([]),[v,j]=(0,x.useState)(!1),{user:I}=(0,m.Z)(),[w,S]=(0,x.useState)(null),[R,b]=(0,x.useState)(!0);return(0,x.useEffect)((()=>{(async()=>{try{if(null!==t.from&&null!==t.to){const e=100*c()(t.from).year()+c()(t.from).month(),a={from:e,to:100*c()(t.to).year()+c()(t.to).month()},r=1===I.role?{userId:I._id,date:a}:{userId:I.parent,date:a},n=await(0,g.I0)(r);"success"===n.type?p.oR.success("History successfully loaded!",{theme:"colored"}):p.oR.error("Update Forecast Error",{theme:"colored"});const o=G(n.data,a);s(o),(e=>{const t=[];e.forEach(((e,a)=>{const r=(0,h.parseInt)(e.date/100),n=e.date-100*r,s="".concat(H[n]," ").concat(r);t.push(s)})),f(t)})(o[0].data)}}catch(e){console.log("fetchForecast Error:",e)}})()}),[t,I._id,I.parent,I.role]),(0,E.jsxs)(l.A,{maxWidth:!e.themeStretch&&"xl",children:[(0,E.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2},children:[(0,E.jsx)(d.A,{variant:"h4",children:!0===R?"Forecast IncomeStatement":"Analysis BalanceSheet"}),(0,E.jsx)(X,{statement:R,setState:e=>b(e)})]}),(0,E.jsx)(o.A,{children:!0===R?(0,E.jsx)(_,{currentResult:r,month:y,date:w,selectedDate:t,handleDateChange:(e,r)=>{if(!e)return;let s;s=r?(0,n.A)((0,n.A)({},t),{},{from:e}):(0,n.A)((0,n.A)({},t),{},{to:e}),a(s)},setDate:e=>S(e),changeResult:e=>s(e)}):(0,E.jsx)(W,{})}),(0,E.jsx)(o.A,{children:(0,E.jsx)(u.A,{component:"label",color:"primary",variant:"contained",onClick:async()=>{j(!0);const e=c()(w).format("MMMM YYYY"),t=100*c()(w).year()+c()(w).month(),a=1===I.role?{userId:I._id,date:e,dateFlag:t,data:r}:{userId:I.parent,date:e,dateFlag:t,data:r};if(a.data&&0!==a.data.length){"success"===await(0,g.BO)(a)?p.oR.success("Forecast successfully Uploaded!",{theme:"colored"}):p.oR.error("Update Forecast Error",{theme:"colored"}),j(!1)}else p.oR.error("Monthly Result data required!",{theme:"colored"}),j(!1)},loading:v,sx:{mt:2,mb:2},startIcon:(0,E.jsx)(i.A,{}),children:"Submit"})})]})}function $(){return(0,E.jsxs)(E.Fragment,{children:[(0,E.jsx)(r.mg,{children:(0,E.jsx)("title",{children:" Dashboard: Details"})}),(0,E.jsx)(Q,{})]})}},97892:(e,t,a)=>{a.d(t,{b:()=>s});var r=a(11238),n=a(72450);const s=e=>{let{data:t,month:a=[],fileName:s,type:c}=e,o=[],l=[];"forecast"===c&&(o=[...["AccountID","RevenueExpenseID","Description"],...a.flatMap((e=>["".concat(e," Actual"),"".concat(e," Forecast")])),"Adjustment","Forecast"],l=t.map((e=>[e.AccountId,e.RevenueExpenseId,e.Description,...e.data.flatMap((e=>[e.actual,e.forecast])),e.userInfo,e.result]))),"balancesheet"===c&&(o=["AccountID",...a],l=t.map((e=>[e.AccountId,...e.data.map((e=>e.amount))]))),"model"===c&&(o=["YEAR","TOTAL REVENUE","TOTAL EXPENSE","NET PROFIT","PROFIT MARGIN"],l=t.map((e=>[e.year,e.totalRevenue,e.totalExpenses,e.netProfit,e.profitMargin])));const d=r.Wp.aoa_to_sheet([o,...l]),i=r.Wp.book_new();r.Wp.book_append_sheet(i,d,"Sheet1");const u=r.M9(i,{bookType:"xlsx",type:"array"}),h=new Blob([u],{type:"application/octet-stream"});(0,n.saveAs)(h,"".concat(s,".xlsx"))}}}]);
//# sourceMappingURL=486.635a4fed.chunk.js.map