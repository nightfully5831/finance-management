"use strict";(self.webpackChunkfinance_dashboard=self.webpackChunkfinance_dashboard||[]).push([[466],{923:(e,t,a)=>{a.d(t,{An:()=>i,Kf:()=>d,Qw:()=>h,Vp:()=>l,_h:()=>p,au:()=>c,om:()=>n,pC:()=>o,vp:()=>s});var r=a(63204);const n=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenueByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}},o=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenue,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheet,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},s=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheetByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Balance Sheet By Month:",t),t}},i=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.getCOA,{userId:e}).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},l=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},d=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},h=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.log("Error Create COA",t),[]}},p=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getAllRevenue,{userId:e}).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},40019:(e,t,a)=>{a.d(t,{A:()=>b});var r=a(11238),n=a(65043),o=a(7353),c=a(12110),s=a(94496),i=a(67784),l=a(51787),d=a(17392),h=a(49633),p=a(79650),u=a(71806),y=a(84882),A=a(68738),v=a(39652),f=a(58093),x=a(73460),m=a(68039),g=a(79484),S=a(34535),w=a(51975),j=a(70579);const C=(0,S.Ay)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});const b=function(e){let{onSetResult:t,currentResult:a,titleArray:S}=e;const[b,R]=(0,n.useState)([]),[I,M]=(0,n.useState)(""),[D,E]=(0,n.useState)(""),[U,O]=(0,n.useState)(""),[P,B]=(0,n.useState)("asc"),[L,Z]=(0,n.useState)(0),[z,_]=(0,n.useState)(7),k=e=>{const a=e.target.files[0];if(a){const e=new FileReader;e.onload=e=>{const a=new Uint8Array(e.target.result),n=r.LF(a,{type:"array"}),o=n.SheetNames[0],c=n.Sheets[o],s=r.Wp.sheet_to_json(c,{header:1});if(s.length>0){const e=(e=>{const t=[];return e.filter((e=>0!==e.length)).map((e=>{const a=[...e];return"string"!==typeof e[0]&&(a[0]=a[0].toString()),"Roll UP"!==S[2]&&(e[1]&&e[3]?("string"!==typeof e[1]&&(a[1]=a[1].toString()),"string"!==typeof e[3]&&(a[3]=a[3].toString())):(a[1]="",a[3]="")),t.push(a),!0})),t})(s.slice(1));t(e)}},e.readAsArrayBuffer(a)}},N=[...b].sort(((e,t)=>{if(!U)return 0;const a=S.indexOf(U);return e[a]<t[a]?"asc"===P?-1:1:e[a]>t[a]?"asc"===P?1:-1:0})).filter((e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.toString().includes(I)})),T=N.slice(L*z,L*z+z);return(0,n.useEffect)((()=>{R(a)}),[a]),(0,j.jsx)(o.A,{sx:{display:"flex",flexDirection:"column",position:"relative",width:"100%",justifyContent:"top",alignItems:"center"},children:(0,j.jsxs)(c.A,{sx:{width:"100%",p:2},children:[(0,j.jsxs)(s.A,{sx:{fontWeight:"500",fontSize:"18px"},children:["Roll UP"===S[2]?"Chart of Account":"Monthly Result"," Table"]}),(0,j.jsxs)(o.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2},children:[(0,j.jsx)(i.A,{variant:"outlined",size:"small",value:D,onChange:e=>{E(e.target.value)},placeholder:"Search by AccountID",InputProps:{endAdornment:(0,j.jsx)(l.A,{position:"end",children:(0,j.jsx)(d.A,{edge:"end",color:"primary",onClick:()=>{M(D)},children:(0,j.jsx)(g.A,{})})})},sx:{width:"40%"}}),(0,j.jsxs)(h.A,{component:"label",color:"primary",variant:"contained",startIcon:(0,j.jsx)(w.A,{}),children:["Upload files",(0,j.jsx)(C,{type:"file",accept:".xlsx",onChange:e=>k(e),multiple:!1})]})]}),(0,j.jsx)(p.A,{children:(0,j.jsxs)(u.A,{children:[(0,j.jsx)(y.A,{children:(0,j.jsx)(A.A,{children:S.map(((e,t)=>(0,j.jsx)(v.A,{style:{textAlign:"center"},children:(0,j.jsx)(f.A,{active:U===e,direction:U===e?P:"asc",onClick:()=>{return B(U===(t=e)&&"asc"===P?"desc":"asc"),void O(t);var t},children:e})},t)))})}),(0,j.jsx)(x.A,{children:T.map(((e,t)=>(0,j.jsx)(A.A,{children:e.map(((e,t)=>(0,j.jsx)(v.A,{style:{padding:"20px",textAlign:"center"},children:e},t)))},t)))})]})}),(0,j.jsx)(m.A,{rowsPerPageOptions:[7,15,20],component:"div",count:N.length,rowsPerPage:z,page:L,onPageChange:(e,t)=>{Z(t)},onRowsPerPageChange:e=>{_(parseInt(e.target.value,10)),Z(0)}})]})})}},10466:(e,t,a)=>{a.r(t),a.d(t,{default:()=>f});var r=a(29490),n=a(65043),o=a(19252),c=a(94496),s=a(74161),i=a(57488),l=(a(92342),a(43374)),d=a(923),h=a(39098),p=a(75139),u=a(40019),y=a(70579);const A=["AccountID","Description","Roll UP","IS/BS"];function v(){const e=(0,h.Mp)(),{user:t}=(0,p.Z)(),[a,r]=(0,n.useState)([]),[v,f]=(0,n.useState)(!1);return(0,n.useEffect)((()=>{(async()=>{const e=1===t.role?t._id:t.parent,a=await(0,d.An)(e);if("success"===a.type){i.oR.success("COA Successfully Upload!",{theme:"colored"});const e=a.data.map((e=>(e.pop(),e)));r(e)}else i.oR.error("COA Upload Error",{theme:"colored"})})()}),[t._id,t.parent,t.role]),(0,y.jsxs)(o.A,{maxWidth:!e.themeStretch&&"xl",children:[(0,y.jsx)(c.A,{variant:"h4",sx:{mb:2},children:" Upload Chart of Account "}),(0,y.jsx)(u.A,{onSetResult:e=>{r(e)},currentResult:a,titleArray:A}),(0,y.jsx)(s.A,{component:"label",color:"primary",variant:"contained",onClick:async()=>{f(!0);const e=JSON.parse(JSON.stringify(a));e.map((e=>(e.push(""),!0))),console.log(t.parent,t.role);const n=1===t.role?{userId:t._id,data:e}:{userId:t.parent,data:e};if(n.data&&0!==n.data.length){const e=await(0,d.Qw)(n);"success"===e.type?i.oR.success("COA Successfully Uploaded",{theme:"colored"}):i.oR.error("COA Upload Error",{theme:"colored"});const t=e.data.map((e=>(e.pop(),e)));r(t),f(!1)}else i.oR.error("COA data required!",{theme:"colored"}),f(!1)},loading:v,sx:{mt:2,mb:2},startIcon:(0,y.jsx)(l.A,{}),children:"Submit"})]})}function f(){return(0,y.jsxs)(y.Fragment,{children:[(0,y.jsx)(r.mg,{children:(0,y.jsx)("title",{children:" Dashboard: COA Upload"})}),(0,y.jsx)(v,{})]})}},43374:(e,t,a)=>{a.d(t,{A:()=>o});var r=a(66734),n=a(70579);const o=(0,r.A)((0,n.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload")},51975:(e,t,a)=>{a.d(t,{A:()=>o});var r=a(66734),n=a(70579);const o=(0,r.A)((0,n.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload")},79484:(e,t,a)=>{a.d(t,{A:()=>o});var r=a(66734),n=a(70579);const o=(0,r.A)((0,n.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},58093:(e,t,a)=>{a.d(t,{A:()=>j});var r=a(89379),n=a(80045),o=a(98610),c=a(58387),s=a(65043),i=a(64551),l=a(66734),d=a(70579);const h=(0,l.A)((0,d.jsx)("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");var p=a(34535),u=a(56262),y=a(98206),A=a(6803),v=a(92532),f=a(72372);function x(e){return(0,f.Ay)("MuiTableSortLabel",e)}const m=(0,v.A)("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc","directionDesc","directionAsc"]),g=["active","children","className","direction","hideSortIcon","IconComponent"],S=(0,p.Ay)(i.A,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.active&&t.active]}})((0,u.A)((e=>{let{theme:t}=e;return{cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(t.vars||t).palette.text.secondary},"&:hover":{color:(t.vars||t).palette.text.secondary,["& .".concat(m.icon)]:{opacity:.5}},["&.".concat(m.active)]:{color:(t.vars||t).palette.text.primary,["& .".concat(m.icon)]:{opacity:1,color:(t.vars||t).palette.text.secondary}}}}))),w=(0,p.Ay)("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.icon,t["iconDirection".concat((0,A.A)(a.direction))]]}})((0,u.A)((e=>{let{theme:t}=e;return{fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:t.transitions.create(["opacity","transform"],{duration:t.transitions.duration.shorter}),userSelect:"none",variants:[{props:{direction:"desc"},style:{transform:"rotate(0deg)"}},{props:{direction:"asc"},style:{transform:"rotate(180deg)"}}]}}))),j=s.forwardRef((function(e,t){const a=(0,y.b)({props:e,name:"MuiTableSortLabel"}),{active:s=!1,children:i,className:l,direction:p="asc",hideSortIcon:u=!1,IconComponent:v=h}=a,f=(0,n.A)(a,g),m=(0,r.A)((0,r.A)({},a),{},{active:s,direction:p,hideSortIcon:u,IconComponent:v}),j=(e=>{const{classes:t,direction:a,active:r}=e,n={root:["root",r&&"active","direction".concat((0,A.A)(a))],icon:["icon","iconDirection".concat((0,A.A)(a))]};return(0,o.A)(n,x,t)})(m);return(0,d.jsxs)(S,(0,r.A)((0,r.A)({className:(0,c.A)(j.root,l),component:"span",disableRipple:!0,ownerState:m,ref:t},f),{},{children:[i,u&&!s?null:(0,d.jsx)(w,{as:v,className:(0,c.A)(j.icon),ownerState:m})]}))}))},92342:()=>{}}]);
//# sourceMappingURL=466.8657098c.chunk.js.map