"use strict";(self.webpackChunkfinance_dashboard=self.webpackChunkfinance_dashboard||[]).push([[404],{923:(e,t,a)=>{a.d(t,{An:()=>l,Kf:()=>d,Qw:()=>u,Vp:()=>c,_h:()=>x,au:()=>o,om:()=>n,pC:()=>s,vp:()=>i});var r=a(63204);const n=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenueByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}},s=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenue,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},o=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheet,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},i=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheetByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Balance Sheet By Month:",t),t}},l=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.getCOA,{userId:e}).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},d=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},u=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.log("Error Create COA",t),[]}},x=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getAllRevenue,{userId:e}).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},57404:(e,t,a)=>{a.r(t),a.d(t,{default:()=>se});var r=a(29490),n=a(65043),s=a(87260),o=a(7104),i=a(7353),l=a(94496),c=a(19252),d=a(68903),u=a(12110),x=a(79958),h=a(26494),p=a(88911),m=a(49633),j=a(57488),y=a(75139);const A=(e,t,a)=>{const r=e.reduce(((e,t)=>e+t.amount),0),n=t.reduce(((e,t)=>e+t.amount),0),s={probable:[],best:[],worst:[]};return["probable","best","worst"].forEach((e=>{const t=a[e],o=[];for(let s=1;s<=a.projectionPeriod;s+=1){const e=r*(1+t.revenueGrowth/100)**(s-1),a=n*(1+t.expenseGrowth/100)**(s-1),i=e-a,l=e>0?i/e*100:0;o.push({year:s,totalRevenue:e,totalExpenses:a,netProfit:i,profitMargin:l})}s[e]=o})),s},b=e=>new Intl.NumberFormat("en-US",{style:"currency",currency:"USD",minimumFractionDigits:0,maximumFractionDigits:0}).format(e),v=function(){let e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:[];const t=[],a=[],r=(e,r)=>{let n=!1;e?(t.length>0&&t.forEach((e=>{e.name===r.name&&(e.amount+=r.amount,e.avg+=r.amount,n=!0)})),!1===n&&t.push(r)):(a.length>0&&a.forEach((e=>{e.name===r.name&&(e.amount+=r.amount,e.avg+=r.amount,n=!0)})),!1===n&&a.push(r))};return(arguments.length>0&&void 0!==arguments[0]?arguments[0]:[]).forEach((t=>{e.forEach((e=>{if(t.accountId===e[0]){const a={id:t.code,name:e[1],amount:t.amount,avg:t.amount,adjust:0};switch(e[4]){case"Revenues":r(!0,a);break;case"COGS/S&O":case"SGA":case"Depreciation & Amortization":case"Cash & Equivalents":r(!1,a)}}}))})),{revenueList:t,expenseList:a}};var f=a(97892),g=a(923),w=a(89379),C=a(40614),k=a(71360),S=a(67784),E=a(17392),R=a(70579);const z=e=>{let{revenueStreams:t,onUpdate:a}=e;const r=(e,r,n)=>{let s=[];s="adjust"!==r?t.map((t=>t.id===e?(0,w.A)((0,w.A)({},t),{},{[r]:n}):t)):t.map((t=>t.id===e?(0,w.A)((0,w.A)({},t),{},{[r]:n,amount:t.avg+n}):t)),a(s)};return(0,R.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,R.jsx)(l.A,{variant:"h6",sx:{fontWeight:500,color:"primary.main",fontSize:"0.875rem"},children:"Revenue Streams"}),(0,R.jsxs)(i.A,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"RevenueName"}),(0,R.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"Average"}),(0,R.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"Adjustment"})]}),(0,R.jsx)(i.A,{sx:{height:"140px",overflowY:"auto",pr:1,"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"3px"}},children:(0,R.jsx)(p.A,{spacing:1.5,children:t.map((e=>{const n=e.id.startsWith("new_");return(0,R.jsxs)(i.A,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)(S.A,{value:e.name,onChange:t=>r(e.id,"name",t.target.value),placeholder:"Revenue stream name",size:"small",sx:{width:"140px","& .MuiInputBase-input":{backgroundColor:"transparent",cursor:n?"text":"default"}},variant:"outlined",InputProps:{readOnly:!n}}),(0,R.jsx)(S.A,{type:"number",value:e.amount,onChange:t=>r(e.id,"amount",parseInt(t.target.value,10)||0),placeholder:"Amount",size:"small",sx:{width:"70px","& .MuiInputBase-input":{backgroundColor:"transparent",cursor:n?"text":"default"}},variant:"outlined",InputProps:{readOnly:!n},disabled:!n}),(0,R.jsx)(S.A,{type:"number",value:n?"no need":e.adjust,onChange:t=>r(e.id,"adjust",parseInt(t.target.value,10)||0),placeholder:n?"no need":"0",size:"small",sx:{width:"70px","& .MuiInputBase-input":{backgroundColor:"transparent",cursor:n?"default":"text"}},variant:"outlined",disabled:n}),(0,R.jsx)(E.A,{onClick:()=>(e=>{a(t.filter((t=>t.id!==e)))})(e.id),size:"small",sx:{color:"error.main","&:hover":{color:"error.dark"}},children:(0,R.jsx)(C.A,{size:16})})]},e.id)}))})}),(0,R.jsx)(m.A,{variant:"text",onClick:()=>{const e={id:"new_".concat(Date.now()),name:"Product ".concat(String.fromCharCode(65+t.length)),amount:0};a([...t,e])},startIcon:(0,R.jsx)(k.A,{size:16}),sx:{color:"primary.main",justifyContent:"flex-start","&:hover":{color:"primary.dark",backgroundColor:"primary.50"}},children:"Add Revenue Stream"})]})},I=e=>{let{expenses:t,onUpdate:a}=e;const r=e=>e.startsWith("new_"),n=(e,r,n)=>{let s=[];s="adjust"!==r?t.map((t=>t.id===e?(0,w.A)((0,w.A)({},t),{},{[r]:n}):t)):t.map((t=>t.id===e?(0,w.A)((0,w.A)({},t),{},{[r]:n,amount:t.avg+n}):t)),a(s)};return(0,R.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column",gap:2},children:[(0,R.jsx)(l.A,{variant:"h6",sx:{fontWeight:500,color:"primary.main",fontSize:"0.875rem"},children:"Expenses"}),(0,R.jsxs)(i.A,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"ExpenseName"}),(0,R.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"Average"}),(0,R.jsx)(l.A,{variant:"subtitle1",sx:{color:"text.secondary",fontSize:"0.875rem"},children:"Adjustment"})]}),(0,R.jsx)(i.A,{sx:{height:"140px",overflowY:"auto",pr:1,"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"3px"}},children:(0,R.jsx)(p.A,{spacing:1.5,children:t.map((e=>{const s=r(e.id);return(0,R.jsxs)(i.A,{sx:{display:"flex",gap:1,alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)(S.A,{value:e.name,onChange:t=>n(e.id,"name",t.target.value),placeholder:"Expense name",size:"small",sx:{width:"140px","& .MuiInputBase-input":{backgroundColor:"transparent",cursor:s?"text":"default"}},variant:"outlined",InputProps:{readOnly:!s}}),(0,R.jsx)(S.A,{type:"number",value:e.amount,onChange:t=>n(e.id,"amount",parseInt(t.target.value,10)||0),placeholder:"Amount",size:"small",sx:{width:"70px","& .MuiInputBase-input":{backgroundColor:"transparent",cursor:s?"text":"default"}},variant:"outlined",InputProps:{readOnly:!s},disabled:!s}),(0,R.jsx)(S.A,{type:"number",value:s?"no need":e.adjust,onChange:t=>n(e.id,"adjust",parseInt(t.target.value,10)||0),placeholder:s?"no need":"0",size:"small",sx:{width:"70px","& .MuiInputBase-input":{backgroundColor:"transparent",cursor:s?"default":"text"}},variant:"outlined",InputProps:{readOnly:s},disabled:s}),(0,R.jsx)(E.A,{onClick:()=>{return n=e.id,void(r(n)&&a(t.filter((e=>e.id!==n))));var n},size:"small",sx:{color:"error.main","&:hover":{color:"error.dark"}},children:(0,R.jsx)(C.A,{size:16})})]},e.id)}))})}),(0,R.jsx)(m.A,{variant:"text",onClick:()=>{const e=t.map((e=>e.name)),r=["Salaries","Rent","Marketing","Equipment","Utilities"].filter((t=>!e.includes(t))),n=r.length>0?r[0]:"Expense ".concat(t.length+1),s={id:"new_".concat(Date.now()),name:n,amount:0};a([...t,s])},startIcon:(0,R.jsx)(k.A,{size:16}),sx:{color:"primary.main",justifyContent:"flex-start","&:hover":{color:"primary.dark",backgroundColor:"primary.50"}},children:"Add Expense"})]})};var W=a(53193),B=a(23914),D=a(94814);const P=e=>{let{settings:t,onUpdate:a}=e;const r=(e,r,n)=>{a((0,w.A)((0,w.A)({},t),{},{[e]:(0,w.A)((0,w.A)({},t[e]),{},{[r]:n})}))},n=(e,a)=>(0,R.jsxs)(i.A,{children:[(0,R.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:500,color:"text.secondary",fontSize:"0.875rem",mb:2},children:e}),(0,R.jsxs)(d.Ay,{container:!0,spacing:2,children:[(0,R.jsx)(d.Ay,{item:!0,xs:6,children:(0,R.jsxs)(i.A,{children:[(0,R.jsx)(l.A,{variant:"caption",sx:{color:"text.disabled",fontSize:"0.75rem",display:"block",mb:.5},children:"Revenue Growth %"}),(0,R.jsx)(S.A,{type:"number",value:t[a].revenueGrowth,onChange:e=>r(a,"revenueGrowth",parseFloat(e.target.value)||0),size:"small",fullWidth:!0,variant:"outlined"})]})}),(0,R.jsx)(d.Ay,{item:!0,xs:6,children:(0,R.jsxs)(i.A,{children:[(0,R.jsx)(l.A,{variant:"caption",sx:{color:"text.disabled",fontSize:"0.75rem",display:"block",mb:.5},children:"Expense Growth %"}),(0,R.jsx)(S.A,{type:"number",value:t[a].expenseGrowth,onChange:e=>r(a,"expenseGrowth",parseFloat(e.target.value)||0),size:"small",fullWidth:!0,variant:"outlined"})]})})]})]});return(0,R.jsxs)(p.A,{spacing:3,children:[n("Probable Case (Base)","probable"),n("Best Case","best"),n("Worst Case","worst"),(0,R.jsxs)(i.A,{children:[(0,R.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:500,color:"text.secondary",fontSize:"0.875rem",mb:1},children:"Projection Period"}),(0,R.jsx)(W.A,{size:"small",fullWidth:!0,children:(0,R.jsxs)(B.A,{value:t.projectionPeriod,onChange:e=>{return r=e.target.value,void a((0,w.A)((0,w.A)({},t),{},{projectionPeriod:r}));var r},variant:"outlined",children:[(0,R.jsx)(D.A,{value:3,children:"3 Years"}),(0,R.jsx)(D.A,{value:5,children:"5 Years"}),(0,R.jsx)(D.A,{value:10,children:"10 Years"})]})})]})]})};var F=a(65204),M=a(79650),G=a(71806),T=a(84882),O=a(68738),_=a(39652),N=a(73460);const U=e=>{let{probableData:t,bestData:a,worstData:r}=e;const[s,o]=(0,n.useState)("probable"),c=(()=>{switch(s){case"best":return a;case"worst":return r;default:return t}})();return(0,R.jsxs)(F.A,{sx:{borderRadius:2,overflow:"hidden"},children:[(0,R.jsx)(i.A,{sx:{p:3},children:(0,R.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",justifyContent:"space-between"},children:[(0,R.jsx)(l.A,{variant:"h6",component:"h3",sx:{fontWeight:600},children:"Financial Summary"}),(0,R.jsx)(p.A,{direction:"row",spacing:1,children:[{scenario:"probable",label:"Probable",activeColor:"#1976d2",activeBgColor:"#e3f2fd"},{scenario:"best",label:"Best",activeColor:"#2e7d32",activeBgColor:"#e8f5e8"},{scenario:"worst",label:"Worst",activeColor:"#d32f2f",activeBgColor:"#ffebee"}].map((e=>{let{scenario:t,label:a,activeColor:r,activeBgColor:n}=e;const i=s===t;return(0,R.jsx)(m.A,{type:"button",onClick:()=>o(t),variant:i?"contained":"outlined",size:"small",sx:(0,w.A)({minWidth:80,fontWeight:500,textTransform:"none"},i?{backgroundColor:n,color:r,"&:hover":{backgroundColor:n,opacity:.8}}:{color:"#666",borderColor:"#e0e0e0","&:hover":{backgroundColor:"#e0e0e0"}}),children:a},t)}))})]})}),(0,R.jsx)(M.A,{children:(0,R.jsxs)(G.A,{sx:{minWidth:650},children:[(0,R.jsx)(T.A,{children:(0,R.jsxs)(O.A,{children:[(0,R.jsx)(_.A,{sx:{fontWeight:600,textTransform:"uppercase",fontSize:"0.75rem"},children:"Year"}),(0,R.jsx)(_.A,{sx:{fontWeight:600,textTransform:"uppercase",fontSize:"0.75rem"},children:"Total Revenue"}),(0,R.jsx)(_.A,{sx:{fontWeight:600,textTransform:"uppercase",fontSize:"0.75rem"},children:"Total Expenses"}),(0,R.jsx)(_.A,{sx:{fontWeight:600,textTransform:"uppercase",fontSize:"0.75rem"},children:"Net Profit"}),(0,R.jsx)(_.A,{sx:{fontWeight:600,textTransform:"uppercase",fontSize:"0.75rem"},children:"Profit Margin"})]})}),(0,R.jsx)(N.A,{children:c.map((e=>{return(0,R.jsxs)(O.A,{sx:{"&:hover":{backgroundColor:"#919EAB"}},children:[(0,R.jsxs)(_.A,{sx:{fontWeight:500,fontSize:"0.875rem"},children:["Year ",e.year]}),(0,R.jsx)(_.A,{sx:{fontSize:"0.875rem"},children:b(e.totalRevenue)}),(0,R.jsx)(_.A,{sx:{fontSize:"0.875rem"},children:b(e.totalExpenses)}),(0,R.jsx)(_.A,{sx:{fontWeight:500,fontSize:"0.875rem",color:e.netProfit>=0?"#2e7d32":"#d32f2f"},children:b(e.netProfit)}),(0,R.jsx)(_.A,{sx:{fontSize:"0.875rem"},children:(t=e.profitMargin,"".concat(t.toFixed(1),"%"))})]},e.year);var t}))})]})})]})};var Y=a(50108),K=a(82291),Z=a(87734),L=a(52185),q=a(6026),V=a(86150),$=a(38643),H=a(75748),Q=a(90168),X=a(60163),J=a(4240),ee=a(17869);const te=e=>{let{active:t,payload:a,label:r}=e;return t&&a&&a.length?(0,R.jsxs)(F.A,{elevation:3,sx:{p:2,backgroundColor:"white",border:"1px solid #e0e0e0"},children:[(0,R.jsx)(l.A,{variant:"subtitle2",sx:{fontWeight:600,mb:1},children:r}),a.map(((e,t)=>(0,R.jsxs)(l.A,{variant:"body2",sx:{color:e.color},children:[e.dataKey,": ",b(e.value)]},t)))]}):null},ae=e=>{let{color:t,label:a}=e;return(0,R.jsxs)(p.A,{direction:"row",alignItems:"center",spacing:1,children:[(0,R.jsx)(i.A,{sx:{width:16,height:16,backgroundColor:t,borderRadius:1}}),(0,R.jsx)(l.A,{variant:"body2",sx:{color:"text.secondary"},children:a})]})},re=e=>{let{probableData:t,bestData:a,worstData:r,revenueStreams:n}=e;const s=t.map((e=>({year:"Year ".concat(e.year),Revenue:e.totalRevenue,Expenses:e.totalExpenses}))),o=t.map(((e,t)=>{var n,s;return{year:"Year ".concat(e.year),"Probable Case":e.netProfit,"Best Case":(null===(n=a[t])||void 0===n?void 0:n.netProfit)||0,"Worst Case":(null===(s=r[t])||void 0===s?void 0:s.netProfit)||0}})),c=n.map(((e,t)=>({name:e.name,value:e.amount,color:["#8B5CF6","#06D6A0","#FFB800"][t%3]})));return(0,R.jsxs)(d.Ay,{container:!0,spacing:3,children:[(0,R.jsx)(d.Ay,{item:!0,xs:12,lg:6,children:(0,R.jsxs)(F.A,{sx:{p:3,height:"100%"},children:[(0,R.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,R.jsx)(l.A,{variant:"h6",component:"h3",children:"Revenue vs Expenses"}),(0,R.jsxs)(p.A,{direction:"row",spacing:2,children:[(0,R.jsx)(ae,{color:"#8B5CF6",label:"Revenue"}),(0,R.jsx)(ae,{color:"#EF4444",label:"Expenses"})]})]}),(0,R.jsx)(Y.u,{width:"100%",height:300,children:(0,R.jsxs)(K.E,{data:s,children:[(0,R.jsx)(Z.d,{strokeDasharray:"3 3"}),(0,R.jsx)(L.W,{dataKey:"year"}),(0,R.jsx)(q.h,{tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,R.jsx)(V.m,{content:(0,R.jsx)(te,{})}),(0,R.jsx)($.y,{dataKey:"Revenue",fill:"#8B5CF6"}),(0,R.jsx)($.y,{dataKey:"Expenses",fill:"#EF4444"})]})})]})}),(0,R.jsx)(d.Ay,{item:!0,xs:12,lg:6,children:(0,R.jsxs)(F.A,{sx:{p:3,height:"100%"},children:[(0,R.jsxs)(i.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mb:2},children:[(0,R.jsx)(l.A,{variant:"h6",component:"h3",children:"Net Profit Comparison"}),(0,R.jsxs)(p.A,{direction:"row",spacing:2,children:[(0,R.jsx)(ae,{color:"#8B5CF6",label:"Probable"}),(0,R.jsx)(ae,{color:"#06D6A0",label:"Best"}),(0,R.jsx)(ae,{color:"#EF4444",label:"Worst"})]})]}),(0,R.jsx)(Y.u,{width:"100%",height:300,children:(0,R.jsxs)(H.b,{data:o,children:[(0,R.jsx)(Z.d,{strokeDasharray:"3 3"}),(0,R.jsx)(L.W,{dataKey:"year"}),(0,R.jsx)(q.h,{tickFormatter:e=>"$".concat((e/1e3).toFixed(0),"k")}),(0,R.jsx)(V.m,{content:(0,R.jsx)(te,{})}),(0,R.jsx)(Q.N,{type:"monotone",dataKey:"Probable Case",stroke:"#8B5CF6",strokeWidth:2}),(0,R.jsx)(Q.N,{type:"monotone",dataKey:"Best Case",stroke:"#06D6A0",strokeWidth:2}),(0,R.jsx)(Q.N,{type:"monotone",dataKey:"Worst Case",stroke:"#EF4444",strokeWidth:2})]})})]})}),(0,R.jsx)(d.Ay,{item:!0,xs:12,children:(0,R.jsxs)(F.A,{sx:{p:3},children:[(0,R.jsx)(l.A,{variant:"h6",component:"h3",sx:{mb:2},children:"Revenue Breakdown"}),(0,R.jsxs)(i.A,{sx:{display:"flex",alignItems:"center",justifyContent:"center"},children:[(0,R.jsx)(Y.u,{width:"100%",height:300,children:(0,R.jsxs)(X.r,{children:[(0,R.jsx)(J.F,{data:c,cx:"50%",cy:"50%",innerRadius:60,outerRadius:120,paddingAngle:5,dataKey:"value",children:c.map(((e,t)=>(0,R.jsx)(ee.f,{fill:e.color},"cell-".concat(t))))}),(0,R.jsx)(V.m,{formatter:e=>b(e)})]})}),(0,R.jsx)(i.A,{sx:{ml:4},children:c.map(((e,t)=>(0,R.jsx)(i.A,{sx:{mb:1},children:(0,R.jsx)(ae,{color:e.color,label:e.name})},t)))})]})]})})]})};function ne(){const{user:e}=(0,y.Z)(),[t,a]=(0,n.useState)(!1),[r,b]=(0,n.useState)([{id:"1",name:"Product A",amount:5e4,adjust:0,avg:0},{id:"2",name:"Product B",amount:35e3,adjust:0,avg:0},{id:"3",name:"Service C",amount:25e3,adjust:0,avg:0}]),[w,C]=(0,n.useState)([{id:"1",name:"Salaries",amount:4e4,adjust:0,avg:0},{id:"2",name:"Rent",amount:12e3,adjust:0,avg:0},{id:"3",name:"Marketing",amount:8e3,adjust:0,avg:0}]),[k,S]=(0,n.useState)({probable:{revenueGrowth:5,expenseGrowth:3},best:{revenueGrowth:10,expenseGrowth:2},worst:{revenueGrowth:2,expenseGrowth:5},projectionPeriod:5}),E=(0,n.useMemo)((()=>A(r,w,k)),[r,w,k]);return(0,n.useEffect)((()=>{(async()=>{try{let t={};const a=1===e.role?e._id:e.parent,r=await(0,g._h)(a);"success"===r.type?j.oR.success("History successfully loaded!",{theme:"colored"}):j.oR.error("Update Forecast Error",{theme:"colored"});const n=await(0,g.An)(a);"success"===n.type?(j.oR.success("COA Successfully Upload!",{theme:"colored"}),r.data.data.length>0&&n.data.length>0&&(t=v(r.data.data,n.data),b(t.revenueList),C(t.expenseList))):j.oR.error("COA Upload Error",{theme:"colored"})}catch(t){console.log("fetchForecast Error:",t)}})()}),[e._id,e.parent,e.role]),(0,n.useEffect)((()=>{if(t){const e=[...E.best,...E.probable,...E.worst];0===e.length?j.oR.warn("Export data is missing",{theme:"colored"}):((0,f.b)({data:e,month:[],fileName:"model ".concat(Date.toString()),type:"model"}),j.oR.success("Model data exported Successfully!",{theme:"colored"})),a(!1)}}),[t,E]),(0,R.jsxs)(i.A,{children:[(0,R.jsxs)(i.A,{sx:{px:1,py:1},children:[(0,R.jsx)(l.A,{variant:"h3",component:"h1",sx:{fontWeight:"bold",mb:1},children:"Financial Scenario Analysis"}),(0,R.jsx)(l.A,{variant:"body1",sx:{fontSize:"1rem"},children:"Analyze different financial scenarios by adjusting revenue and expense inputs"})]}),(0,R.jsx)(c.A,{maxWidth:"xl",sx:{px:3,py:4},children:(0,R.jsxs)(d.Ay,{container:!0,spacing:4,children:[(0,R.jsx)(d.Ay,{item:!0,xs:12,lg:4,children:(0,R.jsxs)(i.A,{sx:{display:"flex",flexDirection:"column"},children:[(0,R.jsxs)(u.A,{sx:{flex:1,display:"flex",flexDirection:"column"},children:[(0,R.jsx)(x.A,{sx:{flexShrink:0},children:(0,R.jsx)(l.A,{variant:"h6",component:"div",children:"Scenario Inputs"})}),(0,R.jsx)(h.A,{sx:{flex:1,overflow:"hidden",display:"flex",flexDirection:"column"},children:(0,R.jsx)(i.A,{sx:{height:"100%",overflowY:"auto",pr:2,"&::-webkit-scrollbar":{width:"6px"},"&::-webkit-scrollbar-track":{backgroundColor:"transparent"},"&::-webkit-scrollbar-thumb":{backgroundColor:"rgba(0,0,0,0.2)",borderRadius:"3px"}},children:(0,R.jsxs)(p.A,{spacing:3,children:[(0,R.jsx)(z,{revenueStreams:r,onUpdate:b}),(0,R.jsx)(I,{expenses:w,onUpdate:C})]})})})]}),(0,R.jsxs)(u.A,{sx:{mt:3},children:[(0,R.jsx)(x.A,{children:(0,R.jsx)(l.A,{variant:"h6",component:"div",children:"Scenario Settings"})}),(0,R.jsx)(h.A,{children:(0,R.jsx)(P,{settings:k,onUpdate:S})})]}),(0,R.jsxs)(p.A,{direction:"row",spacing:2,sx:{mt:3},children:[(0,R.jsx)(m.A,{onClick:()=>{j.oR.success("Scenarios calculated successfully!")},variant:"contained",startIcon:(0,R.jsx)(s.A,{size:16}),color:"secondary",children:"Calculate Scenarios"}),(0,R.jsx)(m.A,{onClick:()=>a(!0),variant:"contained",startIcon:(0,R.jsx)(o.A,{size:16}),color:"primary",children:"Export"})]})]})}),(0,R.jsx)(d.Ay,{item:!0,xs:12,lg:8,children:(0,R.jsxs)(p.A,{spacing:3,children:[(0,R.jsx)(U,{probableData:E.probable,bestData:E.best,worstData:E.worst}),(0,R.jsx)(re,{probableData:E.probable,bestData:E.best,worstData:E.worst,revenueStreams:r})]})})]})})]})}function se(){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(r.mg,{children:(0,R.jsx)("title",{children:" ModelPage "})}),(0,R.jsx)(ne,{})]})}},97892:(e,t,a)=>{a.d(t,{b:()=>s});var r=a(11238),n=a(72450);const s=e=>{let{data:t,month:a=[],fileName:s,type:o}=e,i=[],l=[];"forecast"===o&&(i=[...["AccountID","RevenueExpenseID","Description"],...a.flatMap((e=>["".concat(e," Actual"),"".concat(e," Forecast")])),"Adjustment","Forecast"],l=t.map((e=>[e.AccountId,e.RevenueExpenseId,e.Description,...e.data.flatMap((e=>[e.actual,e.forecast])),e.userInfo,e.result]))),"balancesheet"===o&&(i=["AccountID",...a],l=t.map((e=>[e.AccountId,...e.data.map((e=>e.amount))]))),"model"===o&&(i=["YEAR","TOTAL REVENUE","TOTAL EXPENSE","NET PROFIT","PROFIT MARGIN"],l=t.map((e=>[e.year,e.totalRevenue,e.totalExpenses,e.netProfit,e.profitMargin])));const c=r.Wp.aoa_to_sheet([i,...l]),d=r.Wp.book_new();r.Wp.book_append_sheet(d,c,"Sheet1");const u=r.M9(d,{bookType:"xlsx",type:"array"}),x=new Blob([u],{type:"application/octet-stream"});(0,n.saveAs)(x,"".concat(s,".xlsx"))}}}]);
//# sourceMappingURL=404.41de852c.chunk.js.map