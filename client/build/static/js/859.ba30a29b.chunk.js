"use strict";(self.webpackChunkfinance_dashboard=self.webpackChunkfinance_dashboard||[]).push([[859],{96602:(e,t,a)=>{a.d(t,{BO:()=>n,I0:()=>c,K_:()=>o});var r=a(63204);const o=async(e,t)=>{const a=[];e.data.map((e=>{const r=[...e];r[1]=r[3],r[3]=r[2],r[4]=0;let o=!1;return t.map((e=>(e[0].toString()===r[0]&&(r[2]=e[2],o=!0),!0))),!0===o&&a.push(r),!0})),e.data=a;try{let t="";return await r.Ay.post(r.vZ.forecast.create,e).then((e=>{t="success"})).catch((e=>{t="error"})),t}catch(o){throw console.log("Error Create Forecast",o),o}},n=async e=>{const t=[],a=JSON.parse(JSON.stringify(e));e.data.forEach((e=>{t.push([e.AccountId,e.RevenueExpenseId,e.Description,0,e.result])})),a.data=t;try{let e="";return await r.Ay.post(r.vZ.forecast.update,a).then((t=>{e="success"})).catch((t=>{e="error"})),e}catch(o){throw console.error("Error fetching Revenue By Month:",o),o}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.forecast.get,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},923:(e,t,a)=>{a.d(t,{An:()=>l,Kf:()=>d,Qw:()=>u,Vp:()=>i,_h:()=>h,au:()=>c,om:()=>o,pC:()=>n,vp:()=>s});var r=a(63204);const o=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenueByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}},n=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getRevenue,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},c=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheet,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},s=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.getBalanceSheetByMonth,e).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Balance Sheet By Month:",t),t}},l=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.getCOA,{userId:e}).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.error("Error fetching Revenue:",t),[]}},i=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},d=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.balanceSheet.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.log("Error Create Revenue",t),t}},u=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.coa.create,e).then((e=>{t={type:"success",data:e.data.data.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){return console.log("Error Create COA",t),[]}},h=async e=>{try{let t={type:"",data:{}};return await r.Ay.post(r.vZ.revenue.getAllRevenue,{userId:e}).then((e=>{t={type:"success",data:e.data}})).catch((e=>{t={type:"error",data:e}})),t}catch(t){throw console.error("Error fetching Revenue By Month:",t),t}}},40019:(e,t,a)=>{a.d(t,{A:()=>C});var r=a(11238),o=a(65043),n=a(7353),c=a(12110),s=a(94496),l=a(67784),i=a(51787),d=a(17392),u=a(49633),h=a(79650),p=a(71806),y=a(84882),v=a(68738),A=a(39652),f=a(58093),m=a(73460),x=a(68039),g=a(79484),S=a(34535),w=a(51975),R=a(70579);const j=(0,S.Ay)("input")({clip:"rect(0 0 0 0)",clipPath:"inset(50%)",height:1,overflow:"hidden",position:"absolute",bottom:0,left:0,whiteSpace:"nowrap",width:1});const C=function(e){let{onSetResult:t,currentResult:a,titleArray:S}=e;const[C,b]=(0,o.useState)([]),[I,M]=(0,o.useState)(""),[E,B]=(0,o.useState)(""),[D,U]=(0,o.useState)(""),[Z,_]=(0,o.useState)("asc"),[Y,F]=(0,o.useState)(0),[P,L]=(0,o.useState)(7),O=e=>{const a=e.target.files[0];if(a){const e=new FileReader;e.onload=e=>{const a=new Uint8Array(e.target.result),o=r.LF(a,{type:"array"}),n=o.SheetNames[0],c=o.Sheets[n],s=r.Wp.sheet_to_json(c,{header:1});if(s.length>0){const e=(e=>{const t=[];return e.filter((e=>0!==e.length)).map((e=>{const a=[...e];return"string"!==typeof e[0]&&(a[0]=a[0].toString()),"Roll UP"!==S[2]&&(e[1]&&e[3]?("string"!==typeof e[1]&&(a[1]=a[1].toString()),"string"!==typeof e[3]&&(a[3]=a[3].toString())):(a[1]="",a[3]="")),t.push(a),!0})),t})(s.slice(1));t(e)}},e.readAsArrayBuffer(a)}},z=[...C].sort(((e,t)=>{if(!D)return 0;const a=S.indexOf(D);return e[a]<t[a]?"asc"===Z?-1:1:e[a]>t[a]?"asc"===Z?1:-1:0})).filter((e=>{var t;return null===(t=e[0])||void 0===t?void 0:t.toString().includes(I)})),T=z.slice(Y*P,Y*P+P);return(0,o.useEffect)((()=>{b(a)}),[a]),(0,R.jsx)(n.A,{sx:{display:"flex",flexDirection:"column",position:"relative",width:"100%",justifyContent:"top",alignItems:"center"},children:(0,R.jsxs)(c.A,{sx:{width:"100%",p:2},children:[(0,R.jsxs)(s.A,{sx:{fontWeight:"500",fontSize:"18px"},children:["Roll UP"===S[2]?"Chart of Account":"Monthly Result"," Table"]}),(0,R.jsxs)(n.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",mt:2,mb:2},children:[(0,R.jsx)(l.A,{variant:"outlined",size:"small",value:E,onChange:e=>{B(e.target.value)},placeholder:"Search by AccountID",InputProps:{endAdornment:(0,R.jsx)(i.A,{position:"end",children:(0,R.jsx)(d.A,{edge:"end",color:"primary",onClick:()=>{M(E)},children:(0,R.jsx)(g.A,{})})})},sx:{width:"40%"}}),(0,R.jsxs)(u.A,{component:"label",color:"primary",variant:"contained",startIcon:(0,R.jsx)(w.A,{}),children:["Upload files",(0,R.jsx)(j,{type:"file",accept:".xlsx",onChange:e=>O(e),multiple:!1})]})]}),(0,R.jsx)(h.A,{children:(0,R.jsxs)(p.A,{children:[(0,R.jsx)(y.A,{children:(0,R.jsx)(v.A,{children:S.map(((e,t)=>(0,R.jsx)(A.A,{style:{textAlign:"center"},children:(0,R.jsx)(f.A,{active:D===e,direction:D===e?Z:"asc",onClick:()=>{return _(D===(t=e)&&"asc"===Z?"desc":"asc"),void U(t);var t},children:e})},t)))})}),(0,R.jsx)(m.A,{children:T.map(((e,t)=>(0,R.jsx)(v.A,{children:e.map(((e,t)=>(0,R.jsx)(A.A,{style:{padding:"20px",textAlign:"center"},children:e},t)))},t)))})]})}),(0,R.jsx)(x.A,{rowsPerPageOptions:[7,15,20],component:"div",count:z.length,rowsPerPage:P,page:Y,onPageChange:(e,t)=>{F(t)},onRowsPerPageChange:e=>{L(parseInt(e.target.value,10)),F(0)}})]})})}},78859:(e,t,a)=>{a.r(t),a.d(t,{default:()=>b});var r=a(29490),o=a(65043),n=a(19252),c=a(7353),s=a(94496),l=a(74161),i=a(56813),d=a(57488),u=(a(92342),a(60446)),h=a.n(u),p=a(43374),y=a(923),v=a(39098),A=a(75139),f=a(40019),m=a(96602);const x=(e,t)=>{const a=[],r=[];return e.map((e=>(t.map((t=>(t[0]===e[0]&&("BS"!==t[3]?a.push(e):r.push(e)),!0))),!0))),{IS:a,BS:r}},g=(e,t)=>Object.values(e.reduce(((e,a)=>{let r="";return r="IS"===t?a[3]:a[0],e[r]?e[r][2]+=a[2]:e[r]=[...a],e}),{})),S=async(e,t,a,r)=>{if(e.data&&0!==e.data.length){const o=await(0,y.Vp)(e);"success"===o.type?(d.oR.success("Revenue Successfully Created",{theme:"colored"}),t(o.data)):d.oR.error("Revenue Create Error",{theme:"colored"});"success"===await(0,m.K_)(e,r)?d.oR.success("Forecast Successfully Created",{theme:"colored"}):d.oR.error("Forecast Create Error",{theme:"colored"}),a(!1)}else console.log("Monthly Result data required!"),a(!1)},w=async(e,t,a)=>{if(e.data&&0!==e.data.length){const r=await(0,y.Kf)(e);"success"===r.type?(d.oR.success("BS Successfully created",{theme:"colored"}),a(r.data)):d.oR.error("BS Create Error",{theme:"colored"}),t(!1)}else console.log("BS data required!"),t(!1)};var R=a(70579);const j=["AccountID","Revenue/Expense Description","Amount($)","Revenue/Expense ID"];function C(){const e=(0,v.Mp)(),{user:t}=(0,A.Z)(),[a,r]=(0,o.useState)(h()()),[u,m]=(0,o.useState)([]),[C,b]=(0,o.useState)([]),[I,M]=(0,o.useState)(!1),[E,B]=(0,o.useState)([]),[D,U]=(0,o.useState)([]);return(0,o.useEffect)((()=>{(async()=>{const e=1===t.role?t._id:t.parent,a=await(0,y.An)(e);"success"===a.type?(d.oR.success("COA Successfully Upload!",{theme:"colored"}),b(a.data)):d.oR.error("COA Upload Error",{theme:"colored"})})(),(async()=>{const e=h()(a).format("MMMM YYYY"),r=1===t.role?{userId:t._id,date:e}:{userId:t.parent,date:e},o=await(0,y.pC)(r);"success"===o.type?(d.oR.success("Revenue Successfully Upload!",{theme:"colored"}),B(o.data)):d.oR.error("Revenue Upload Error",{theme:"colored"})})(),(async()=>{const e=h()(a).format("MMMM YYYY"),r=1===t.role?{userId:t._id,date:e}:{userId:t.parent,date:e},o=await(0,y.au)(r);"success"===o.type?(d.oR.success("BalanceSheet Successfully Upload!",{theme:"colored"}),U(o.data)):d.oR.error("BalanceSheet Upload Error",{theme:"colored"})})()}),[a,t._id,t.parent,t.role]),(0,o.useEffect)((()=>{const e=[...E,...D];m(e)}),[E,D]),(0,R.jsxs)(n.A,{maxWidth:!e.themeStretch&&"xl",children:[(0,R.jsxs)(c.A,{sx:{display:"flex",justifyContent:"space-between",alignItems:"center",pb:2},children:[(0,R.jsx)(s.A,{variant:"h4",children:" Upload Transactions "}),(0,R.jsx)(c.A,{sx:{display:"flex",justifyContent:"flex-end",mr:4,border:"2px solid",borderColor:"#007867",borderRadius:1,p:.2},children:(0,R.jsx)(i.l,{views:["month","year"],value:a,onChange:e=>{r(e)}})})]}),(0,R.jsx)(f.A,{onSetResult:e=>{const t=x(e,C),a=g(t.IS,"IS"),r=g(t.BS,"BS"),o=[...a,...r];B(a),U(r),m(o)},currentResult:u,titleArray:j}),(0,R.jsx)(l.A,{component:"label",color:"primary",variant:"contained",onClick:async()=>{M(!0);const e=h()(a).format("MMMM YYYY"),r=100*h()(a).year()+h()(a).month(),o=1===t.role?{userId:t._id,date:e,dateFlag:r,data:E}:{userId:t.parent,date:e,dateFlag:r,data:E},n=1===t.role?{userId:t._id,date:e,dateFlag:r,data:D}:{userId:t.parent,date:e,dateFlag:r,data:D};S(o,B,M,C),w(n,M,U),m([...E,...D])},loading:I,sx:{mt:2,mb:2},startIcon:(0,R.jsx)(p.A,{}),children:"Submit"})]})}function b(){return(0,R.jsxs)(R.Fragment,{children:[(0,R.jsx)(r.mg,{children:(0,R.jsx)("title",{children:" Dashboard: TransactionUpload"})}),(0,R.jsx)(C,{})]})}},43374:(e,t,a)=>{a.d(t,{A:()=>n});var r=a(66734),o=a(70579);const n=(0,r.A)((0,o.jsx)("path",{d:"M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96M14 13v4h-4v-4H7l5-5 5 5z"}),"CloudUpload")},51975:(e,t,a)=>{a.d(t,{A:()=>n});var r=a(66734),o=a(70579);const n=(0,r.A)((0,o.jsx)("path",{d:"M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"}),"FileUpload")},79484:(e,t,a)=>{a.d(t,{A:()=>n});var r=a(66734),o=a(70579);const n=(0,r.A)((0,o.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},58093:(e,t,a)=>{a.d(t,{A:()=>R});var r=a(89379),o=a(80045),n=a(98610),c=a(58387),s=a(65043),l=a(64551),i=a(66734),d=a(70579);const u=(0,i.A)((0,d.jsx)("path",{d:"M20 12l-1.41-1.41L13 16.17V4h-2v12.17l-5.58-5.59L4 12l8 8 8-8z"}),"ArrowDownward");var h=a(34535),p=a(56262),y=a(98206),v=a(6803),A=a(92532),f=a(72372);function m(e){return(0,f.Ay)("MuiTableSortLabel",e)}const x=(0,A.A)("MuiTableSortLabel",["root","active","icon","iconDirectionDesc","iconDirectionAsc","directionDesc","directionAsc"]),g=["active","children","className","direction","hideSortIcon","IconComponent"],S=(0,h.Ay)(l.A,{name:"MuiTableSortLabel",slot:"Root",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.root,a.active&&t.active]}})((0,p.A)((e=>{let{theme:t}=e;return{cursor:"pointer",display:"inline-flex",justifyContent:"flex-start",flexDirection:"inherit",alignItems:"center","&:focus":{color:(t.vars||t).palette.text.secondary},"&:hover":{color:(t.vars||t).palette.text.secondary,["& .".concat(x.icon)]:{opacity:.5}},["&.".concat(x.active)]:{color:(t.vars||t).palette.text.primary,["& .".concat(x.icon)]:{opacity:1,color:(t.vars||t).palette.text.secondary}}}}))),w=(0,h.Ay)("span",{name:"MuiTableSortLabel",slot:"Icon",overridesResolver:(e,t)=>{const{ownerState:a}=e;return[t.icon,t["iconDirection".concat((0,v.A)(a.direction))]]}})((0,p.A)((e=>{let{theme:t}=e;return{fontSize:18,marginRight:4,marginLeft:4,opacity:0,transition:t.transitions.create(["opacity","transform"],{duration:t.transitions.duration.shorter}),userSelect:"none",variants:[{props:{direction:"desc"},style:{transform:"rotate(0deg)"}},{props:{direction:"asc"},style:{transform:"rotate(180deg)"}}]}}))),R=s.forwardRef((function(e,t){const a=(0,y.b)({props:e,name:"MuiTableSortLabel"}),{active:s=!1,children:l,className:i,direction:h="asc",hideSortIcon:p=!1,IconComponent:A=u}=a,f=(0,o.A)(a,g),x=(0,r.A)((0,r.A)({},a),{},{active:s,direction:h,hideSortIcon:p,IconComponent:A}),R=(e=>{const{classes:t,direction:a,active:r}=e,o={root:["root",r&&"active","direction".concat((0,v.A)(a))],icon:["icon","iconDirection".concat((0,v.A)(a))]};return(0,n.A)(o,m,t)})(x);return(0,d.jsxs)(S,(0,r.A)((0,r.A)({className:(0,c.A)(R.root,i),component:"span",disableRipple:!0,ownerState:x,ref:t},f),{},{children:[l,p&&!s?null:(0,d.jsx)(w,{as:A,className:(0,c.A)(R.icon),ownerState:x})]}))}))},92342:()=>{}}]);
//# sourceMappingURL=859.ba30a29b.chunk.js.map